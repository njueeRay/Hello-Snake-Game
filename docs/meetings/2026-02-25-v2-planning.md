# 会议纪要 — v2.0 规划全体会议

| 项目 | 内容 |
|---|---|
| **日期** | 2026-02-25 |
| **类型** | 全体规划会议 |
| **主持** | 高级助理（PM） |
| **出席** | PM · Architect · Implementer · Code Reviewer |
| **目标** | v1.0 验收确认 + v2.0 目标定义 + Sprint 规划 + 分工 |

---

## 一、v1.0 验收确认

**PM 主持，Code Reviewer 报告：**

v1.0.0 已于本日完成全部验收动作：

| 验收项 | 状态 |
|---|---|
| 所有规划功能完整实现 | ✅ |
| README / CHANGELOG / LICENSE / CONTRIBUTING | ✅ |
| GitHub Pages 自动部署 CI/CD | ✅ |
| git tag v1.0.0 已打 | ✅ |
| GitHub Release 已发布 | ✅ |
| 代码审查（Critical 全部修复） | ✅ |

**决议：v1.0.0 正式验收通过，进入 v2.0 规划阶段。**

---

## 二、v1.0 回顾（retrospective）

### 做得好的地方

**Architect：**
- 模块分层清晰（game / renderer / ui / audio 完全解耦），未来扩展成本低
- effects[] 统一管理特效，新增特效只需 push 对象
- Obstacles 类接口简洁（generate / checkCollision / getPositions），可复用

**Code Reviewer：**
- 代码风格统一，无全局变量，无 `var`
- 所有边界条件（null guard、暂停状态、音频 suspended）经过审查修复
- CHANGELOG 和文档完整

**Implementer：**
- 4 个 Sprint 全部按时完成
- agent 权限问题修复后，子 agent 协作模式运行稳定

### 需要改进的地方

**PM：**
- 会议应更早建立 `docs/meetings/` 沉淀决策记录（本次补齐）
- `.gitignore` 中 `tmpclaude-*` 已配置，但 `nul` 文件漏掉 → 已修复

**Architect：**
- `renderer.js` 有少量魔法数字（眼睛半径、步长等）可提取为常量，v2.0 中补齐
- `ui.js` 中有部分 `textContent` 方法可考虑通过模板集中管理（v2.0 新增 UI 较多时重要）

**Implementer：**
- `game.js` 行数增长较快（~410 行），v2.0 新增游戏模式时应考虑拆分 `GameMode` 策略类

---

## 三、v2.0 目标定义

**PM 发言：**

> v2.0 的核心目标是从"功能完整的单机游戏"升级为"有重玩价值和社交属性的精品小游戏"。
> 具体方向：提升进深感（排行榜/连击系统）、增加游戏模式多样性（限时模式）、提升视觉个性化（皮肤）。

**Architect 评估（3 个优先级维度：体验价值 / 技术复杂度 / 架构影响）：**

### 候选功能清单

| # | 功能 | 体验价值 | 技术复杂度 | 架构影响 | 优先级 |
|---|---|---|---|---|---|
| F1 | **本地 Top-10 排行榜** | 高（重玩动力） | 低 | 小（localStorage 扩展） | P0 |
| F2 | **连击/倍数系统** | 高（操作深度） | 低-中 | 小（game.js + renderer） | P0 |
| F3 | **限时模式（Time Attack）** | 高（模式多样性） | 中 | 中（需 GameMode 抽象） | P0 |
| F4 | **结构化障碍物图案** | 中（游戏设计提升） | 中 | 小（obstacles.js 扩展） | P1 |
| F5 | **蛇皮肤选择** | 中（个性化） | 低 | 小（renderer + 开始界面） | P1 |
| F6 | **暂停界面增强** | 中（体验打磨） | 低 | 小（ui.js + style.css） | P1 |
| F7 | **背景音乐** | 中（氛围感） | 中 | 小（audio.js 扩展） | P2 |
| F8 | **在线排行榜** | 高（社交属性） | 高（需后端） | 大（需 API 层） | v2.x |
| F9 | **双人模式** | 高（社交属性） | 高（输入架构重构） | 大 | v2.x |

### 功能技术方案（Architect）

**F1 本地 Top-10 排行榜**
- `localStorage` 存储 `snakeLeaderboard` JSON 数组，结构：`{score, level, difficulty, date}`
- 新增 `src/leaderboard.js` 模块（read / add / clear）
- `ui.js` 增加排行榜 overlay，游戏结束后展示
- **影响文件**：`leaderboard.js`（新建）、`game.js`、`ui.js`、`index.html`、`style.css`

**F2 连击/倍数系统**
- 连续吃食物（间隔 < N 格移动）累积 combo counter；中断重置
- 倍数：1 / 1.5 / 2 / 3x（combo 1 / 3 / 6 / 10）
- `game.js` 添加 `_comboCount`、`_lastFoodTime`；分数乘以倍数
- `renderer.js` 新增 `_drawComboIndicator()`（连击数+火焰特效）
- **影响文件**：`game.js`、`renderer.js`、`style.css`（HUD 连击显示）

**F3 限时模式（Time Attack）**
- 60 秒倒计时；蛇吃食物不增长（保持固定长度 = 3）；满屏不可能 → 移除 WIN 条件
- 开始界面增加"TIME ATTACK"按钮
- `game.js` 提取 `_gameModeConfig` 对象区分 classic / timeattack 行为差异
- 倒计时渲染：`renderer.js` drawHUD 或 `ui.js` DOM 显示
- **影响文件**：`game.js`、`ui.js`、`index.html`、`style.css`

**F4 结构化障碍物图案**
- `obstacles.js` 新增 `PATTERNS` 常量数组（十字形、L形、边框局部、散点）
- Level 3-5 随机选 pattern；Level 6+ 叠加多个 pattern；上限维持 12 块
- 保持向后兼容：`generate()` 接受可选参数 `{usePattern: boolean}`
- **影响文件**：`obstacles.js`

**F5 蛇皮肤选择**
- 开始界面增加皮肤选择器（4 种：默认绿、赛博蓝、霓虹紫、金色）
- `renderer.js` 的 `drawSnake()` 接受 `skinConfig` 参数
- `game.js` 存储 `this.skin`，localStorage 记住选择
- **影响文件**：`renderer.js`、`game.js`、`index.html`、`style.css`

**F6 暂停界面增强**
- 暂停 overlay 新增：当前分数/等级/难度/耗时；"放弃本局"按钮（→重回开始界面）
- `ui.js` `showPause()` 接收更多 stats
- `game.js` 追踪游戏时长（`_gameStartTime`）
- **影响文件**：`ui.js`、`game.js`、`index.html`、`style.css`

**F7 背景音乐**
- `audio.js` 新增 `startBgm()` / `stopBgm()`：用低频 oscillator + 滤波器合成环境音循环
- 音乐随移动速度（tickInterval）轻微变调（紧张感）
- Mute 按钮同步控制 BGM
- **影响文件**：`audio.js`

---

## 四、Sprint 规划（v2.0）

**PM 决策，Architect 技术确认：**

### Sprint 5 — "深度体验"（P0 功能）

**目标**：让老玩家重玩有动力、操作有深度

| 功能 | 负责 | 预估工作量 |
|---|---|---|
| F1 本地 Top-10 排行榜 | Implementer | 中（新文件+UI） |
| F2 连击/倍数系统 | Implementer | 中（逻辑+特效） |
| F6 暂停界面增强 | Implementer | 小 |

**交付物**：
- `src/leaderboard.js`（新建）
- `game.js`、`ui.js`、`renderer.js`、`index.html`、`style.css` 更新
- README 更新

---

### Sprint 6 — "玩法扩展"（P0 + P1）

**目标**：增加游戏模式，提升视觉个性化

| 功能 | 负责 | 预估工作量 |
|---|---|---|
| F3 限时模式 | Implementer | 大（模式分支） |
| F5 蛇皮肤选择 | Implementer | 中 |
| F4 结构化障碍物图案 | Implementer | 中 |

**交付物**：
- `obstacles.js` 扩展（PATTERNS）
- `game.js`、`renderer.js`、`ui.js`、`index.html`、`style.css` 更新

---

### Sprint 7 — "氛围打磨"（P2 + 技术债）

**目标**：音效升级，代码质量收尾，准备 v2.0 发布

| 功能 | 负责 | 预估工作量 |
|---|---|---|
| F7 背景音乐 | Implementer | 中 |
| renderer.js 魔法数字常量化 | Implementer | 小 |
| game.js 行数拆分考察 | Architect + Implementer | 视情况 |
| 全量代码 Review | Code Reviewer | — |
| v2.0.0 发版 | PM | — |

---

## 五、分工确认

| 角色 | 职责 |
|---|---|
| **PM（高级助理）** | Sprint 主持、会议纪要、CLAUDE.md 更新、发版管理 |
| **Architect** | 每 Sprint 前方案设计、技术风险评估、架构边界守护 |
| **Implementer** | 代码实现（各 Sprint 全部功能） |
| **Code Reviewer** | Sprint 结束后全量审查，Critical 问题阻塞发版 |

---

## 六、技术决策记录（ADR）

**ADR-001：不引入框架**
> v2.0 维持纯 Vanilla JS。功能复杂度在无框架范围内可控，引入框架会破坏"零依赖"的技术亮点。

**ADR-002：游戏模式通过配置对象区分，不重构为类继承**
> 限时模式与经典模式差异有限，用 `_gameModeConfig` 对象选项控制行为分支比引入策略类更简单，避免过度设计。

**ADR-003：在线排行榜推迟到 v2.x**
> 需要后端服务，超出静态 GitHub Pages 部署范围，与"零依赖部署"原则冲突，列入 v2.x roadmap。

**ADR-004：双人模式推迟到 v2.x**
> 需要重构输入架构和碰撞检测（两条蛇互撞），复杂度高，当前优先提升单人体验深度。

---

## 七、行动项

| 行动 | 负责人 | 时限 |
|---|---|---|
| 更新 CLAUDE.md（v2.0 规划） | PM | 本次会议后立即 |
| 更新 README Roadmap（v2.0 功能项） | PM | 本次会议后立即 |
| 启动 Sprint 5 实现 | Implementer | 下次迭代 |
| 建立 `docs/meetings/` 目录并归档本纪要 | PM | ✅ 已完成 |

---

*会议纪要由 PM（高级助理）整理，经全体成员确认。*
